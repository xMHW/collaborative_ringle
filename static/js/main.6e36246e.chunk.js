(this.webpackJsonpdocument=this.webpackJsonpdocument||[]).push([[0],{137:function(e,t,n){},139:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(71),o=n.n(a),i=(n(137),n(57)),u=n(5),s=n.n(u),f=n(17),l=n(8),d=(n(139),n(6)),g=n(130),O=n.n(g);function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!e.includes("undefined")){var c=null;t&&(c="Bearer "+t);var a=null;return a=r?{method:n,headers:{Authorization:c,"Content-Type":"application/json"},body:JSON.stringify(r)}:{method:n,headers:{Authorization:c,"COntent-Type":"application/json"}},O()(e,a).then((function(e){return e.json()})).then((function(e){return e}),(function(e){return{success:!1,error:e}}))}}var j=n(3),h=function(e,t){var n=Object(r.useRef)(!1);Object(r.useEffect)((function(){n.current?e():n.current=!0}),t)},p=n(12),v=function(e){var t=e.uuid,n=e.currentCard,c=e.findPrevCard,a=e.findNextCard,o=e.createdNewCardAtTree,i=e.setCurrentCard,u=e.deleteCurrentCardFromTree,g=e.setBackSpace,O=e.backSpace,v=e.mergePending,C=e.setMergePending,S=e.cardCreated,k=e.setCardCreated,w=e.goUp,x=e.setGoUp,m=e.socket,y=(e.setSocket,Object(r.useState)((function(){return j.EditorState.createEmpty()}))),T=Object(l.a)(y,2),F=T[0],E=T[1],B=new Date,P=Object(r.useState)(),A=Object(l.a)(P,2),L=A[0],R=A[1],N=Object(d.e)().userId,I=Object(r.useState)(),M=Object(l.a)(I,2),D=(M[0],M[1]),J=Object(r.useState)(!1),W=Object(l.a)(J,2),G=(W[0],W[1],Object(r.useState)(!1)),U=Object(l.a)(G,2),_=U[0],K=U[1],z=Object(r.useState)(!1),H=Object(l.a)(z,2),q=(H[0],H[1]),Q=Object(r.useRef)(),V="http://54.180.147.138";Object(r.useEffect)((function(){if(null!=m&&null!=F&&0!=_){var e=F.getCurrentContent(),n=Object(j.convertToRaw)(e);m.emit("send-changes",{delta:n,id:N,objectId:t}),K(!1)}}),[m,F,_]),Object(r.useEffect)((function(){if(null!=m&&null!=F){var e=function(e){if(e.id!=N&&e.objectId==t){var n=Object(j.convertFromRaw)(e.delta),r=F.getSelection(),c=(r.getAnchorOffset(),r.getFocusOffset(),j.EditorState.set(F,{currentContent:n}));E(c)}};return m.on("receive-changes",e),function(){m.off("receive-changes",e)}}}),[m,F]),h((function(){var e=B.getHours()+":"+B.getMinutes()+":"+B.getSeconds();R(e),ee(t),console.log(F.getSelection(),t)}),[F]);var X=function(e,t){var n=e.getCurrentContent(),r=t.getCurrentContent(),c=n.getPlainText(),a=n.getFirstBlock().getCharacterList(),o=r.getPlainText(),i=r.getFirstBlock().getCharacterList();return c!=o||a!=i},Y=function(e,t){var n=e.getSelection(),r=t.getSelection(),c=n.getStartOffset(),a=r.getStartOffset(),o=n.getFocusOffset(),i=r.getFocusOffset();return c!=a||o!=i};h((function(){if(n==t&&Q.current){if(Q.current.focus(),S){var e=F.getCurrentContent(),r=F.getSelection(),c=e.getPlainText().length,a=r.merge({focusOffset:c,anchorOffset:c,hasFocus:!0});E(j.EditorState.acceptSelection(F,a)),k(!1)}if(O){if(E(j.EditorState.moveFocusToEnd(F)),v){var o=F.getCurrentContent(),i=F.getSelection(),u=i.getFocusKey(),s=o.getPlainText().length,f=te(o,v),l=Object(j.convertToRaw)(f),d=j.EditorState.createWithContent(Object(j.convertFromRaw)(l)),b=i.merge({focusKey:u,focusOffset:s,anchorOffset:s,hasFocus:!0});E(j.EditorState.acceptSelection(d,b)),C(null)}g(!1)}w&&(E(j.EditorState.moveFocusToEnd(F)),x(!1))}}),[n]),Object(r.useEffect)((function(){S||Z(t)}),[]);var Z=function(){var e=Object(f.a)(s.a.mark((function e(t){var n,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("".concat(V,"/card/find"),null,"POST",{_id:t});case 2:n=e.sent,D(n),n&&(r=JSON.parse(n.content),c=j.EditorState.createWithContent(Object(j.convertFromRaw)(r)),E(c));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(f.a)(s.a.mark((function e(){var t,n,r,c,a,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:j.EditorState.createEmpty(),n=t.getCurrentContent(),r=Object(j.convertToRaw)(n),c=JSON.stringify(r),e.next=6,b("".concat(V,"/card/create"),null,"POST",{content:c,created:L,updater:N});case 6:a=e.sent,o(a._id),i(a._id);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(f.a)(s.a.mark((function e(t){var n,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=F.getCurrentContent(),r=Object(j.convertToRaw)(n),c=JSON.stringify(r),e.next=5,b("".concat(V,"/card/update"),null,"POST",{_id:t,content:c,created:L,updater:N});case 5:e.sent;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(e,t){e.getBlockMap();var n=e.getLastBlock(),r=ne(n,t);return j.ContentState.createFromBlockArray([r])},ne=function(e,t){return new j.ContentBlock({key:e.getKey(),text:e.getText().concat(t.getText()),characterList:e.getCharacterList(),depth:e.getDepth(),data:e.getData()})};return Object(p.jsx)("div",{className:"cards",onKeyDown:function(e){if(8===e.keyCode){var n=F.getCurrentContent(),r=n.getPlainText().length,o=F.getSelection(),i=o.getFocusOffset(),s=(n.getBlockMap(),n.getFirstBlock()),f=o.getAnchorOffset();if(0===i)if(0===r)g(!0),u(t);else{if(0!=f)return;g(!0),C(s),u(t)}}if("ArrowUp"===e.key)return 0===F.getSelection().getStartOffset()&&c(t),void console.log("arrow up");if("ArrowDown"===e.key)return function(){var e=F.getCurrentContent().getLastBlock().getLength();F.getSelection().getStartOffset()===e&&a(t)}(),void console.log("arrow down");if("ArrowLeft"===e.key){F.getCurrentContent();0===F.getSelection().getFocusOffset()&&(console.log("Arrow left"),c(t))}if("ArrowRight"===e.key){var l=F.getCurrentContent();F.getSelection().getFocusOffset()===l.getPlainText().length&&(console.log("Arrow right"),a(t))}if(e.key,13===e.keyCode){var d=F.getCurrentContent();if(F.getSelection().getFocusOffset()==d.getPlainText().length){console.log("newCard!!!!!!");var O=d.getFirstBlock(),b=j.ContentState.createFromBlockArray([O]),h=j.EditorState.createWithContent(b);E(h),k(!0),$()}else{E(j.EditorState.undo(F));var p=F.getSelection(),v=j.Modifier.splitBlock(d,p),S=j.ContentState.createFromBlockArray([v.getFirstBlock()]),w=j.EditorState.createWithContent(S);E(w);var x=j.ContentState.createFromBlockArray([v.getLastBlock()]),m=j.EditorState.createWithContent(x);$(m)}}},children:Object(p.jsx)(j.Editor,{editorState:F,onChange:function(e){console.log(X(F,e)),X(F,e)&&K(!0),Y(F,e)&&q(!0),E(e),i(t)},ref:Q})})},C=n(132),S="http://54.180.147.138",k=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),o=Object(l.a)(a,2),u=o[0],g=o[1],O=Object(r.useState)(!1),j=Object(l.a)(O,2),k=(j[0],j[1],Object(r.useState)([])),w=Object(l.a)(k,2),x=(w[0],w[1],Object(d.e)().userId),m=Object(r.useState)(!1),y=Object(l.a)(m,2),T=y[0],F=y[1],E=Object(r.useState)(null),B=Object(l.a)(E,2),P=B[0],A=B[1],L=Object(r.useState)(!1),R=Object(l.a)(L,2),N=R[0],I=R[1],M=Object(r.useState)(!1),D=Object(l.a)(M,2),J=D[0],W=D[1],G=Object(r.useState)(),U=Object(l.a)(G,2),_=U[0],K=U[1],z=Object(r.useState)(!1),H=Object(l.a)(z,2),q=H[0],Q=H[1],V=Object(r.useState)(0),X=Object(l.a)(V,2),Y=X[0],Z=X[1];Object(r.useEffect)((function(){ee()}),[]),Object(r.useEffect)((function(){$(n.length)&&Q(!0),Z(n.length)}),[n]);var $=function(e){return Y!=e};Object(r.useEffect)((function(){var e=Object(C.io)("http://54.180.147.138:5000");return K(e),function(){e.disconnect()}}),[]),h((function(){null!=_&&null!=n&&0!=q&&(_.emit("send-tree-changes",{delta:n,id:x}),Q(!0))}),[_,n,q]),h((function(){if(null!=_&&null!=n){_.on("receive-tree-changes",(function(e){e.id!=x&&c(e.delta)}))}}),[_,n]);var ee=function(){var e=Object(f.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("".concat(S,"/tree/find/all"),null,"GET",null);case 2:t=e.sent,c(t[0].cards);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(f.a)(s.a.mark((function e(t){var n,r,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("".concat(S,"/card/find/all"),null,"GET",null);case 2:for(n=e.sent,r=n.map((function(e){return e._id})),a=0;a<t.length;a++)-1===r.indexOf(t[a])&&(o=t.indexOf(t[a]),t.splice(o,1));c(t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(f.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return te(n),e.next=3,b("".concat(S,"/tree/update"),null,"POST",{page:t,cards:["608b3f2157e25818a1d3ff16","608b3f3557e25818a1d3ff17"]});case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),re=function(e,t){var r=n.indexOf(e);-1!==r&&0!==r&&(g(n[r-1]),W(!0))},ce=function(e){var t=n.indexOf(e);-1!==t?n[t+1]?(console.log("Nothing went wrong!"),g(n[t+1])):console.log("There is no Card After this one!!!!!"):console.log("That card uuid is Invalid!!!!!!!")},ae=function(e){var t=n.indexOf(u),r=[];if(-1===t)r=[].concat(Object(i.a)(n),[e]),c(r);else{var a=Object(i.a)(n);a.splice(t+1,0,e),c(r=a)}ne(1,r)},oe=function(){var e=n.indexOf(u);g(n[e-1]);var t=[];if(-1!==e){var r=Object(i.a)(n);r.splice(e,1),c(t=r),ne(1,t)}};return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("div",{style:{padding:16,width:1100,backgroundColor:"white",maxWidth:1100,borderRadius:8,display:"inline-block"},children:n.map((function(e){return Object(p.jsx)(v,{uuid:e,currentCard:u,findPrevCard:re,findNextCard:ce,createdNewCardAtTree:ae,setCurrentCard:g,deleteCurrentCardFromTree:oe,setBackSpace:F,backSpace:T,mergePending:P,setMergePending:A,cardCreated:N,setCardCreated:I,goUp:J,setGoUp:W,socket:_,setSocket:K},e)}))})})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,269)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))},x=n(55);o.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(x.a,{children:Object(p.jsx)(d.a,{exact:!0,path:"/:userId",component:k})})}),document.getElementById("root")),w()}},[[268,1,2]]]);
//# sourceMappingURL=main.6e36246e.chunk.js.map