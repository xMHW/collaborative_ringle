(this.webpackJsonpdocument=this.webpackJsonpdocument||[]).push([[0],{137:function(e,t,n){},139:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(71),a=n.n(c),o=(n(137),n(57)),i=n(5),u=n.n(i),s=n(17),f=n(8),l=(n(139),n(6)),d=n(130),g=n.n(d);function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!e.includes("undefined")){var c=null;t&&(c="Bearer "+t);var a=null;return a=r?{method:n,headers:{Authorization:c,"Content-Type":"application/json"},body:JSON.stringify(r)}:{method:n,headers:{Authorization:c,"COntent-Type":"application/json"}},g()(e,a).then((function(e){return e.json()})).then((function(e){return e}),(function(e){return{success:!1,error:e}}))}}var b=n(3),j=function(e,t){var n=Object(r.useRef)(!1);Object(r.useEffect)((function(){n.current?e():n.current=!0}),t)},h=n(12),p=function(e){var t=e.uuid,n=e.currentCard,c=e.findPrevCard,a=e.findNextCard,o=e.createdNewCardAtTree,i=e.setCurrentCard,d=e.deleteCurrentCardFromTree,g=e.setBackSpace,p=e.backSpace,v=e.mergePending,C=e.setMergePending,S=e.cardCreated,k=e.setCardCreated,w=e.goUp,x=e.setGoUp,m=e.socket,y=(e.setSocket,Object(r.useState)((function(){return b.EditorState.createEmpty()}))),T=Object(f.a)(y,2),F=T[0],E=T[1],B=new Date,P=Object(r.useState)(),A=Object(f.a)(P,2),L=A[0],R=A[1],N=Object(l.f)().userId,I=Object(r.useState)(),_=Object(f.a)(I,2),D=(_[0],_[1]),J=Object(r.useState)(!1),M=Object(f.a)(J,2),W=(M[0],M[1],Object(r.useState)(!1)),G=Object(f.a)(W,2),U=G[0],K=G[1],z=Object(r.useState)(!1),H=Object(f.a)(z,2),q=(H[0],H[1]),Q=Object(r.useRef)(),V="http://54.180.147.138";Object(r.useEffect)((function(){if(null!=m&&null!=F&&0!=U){var e=F.getCurrentContent(),n=Object(b.convertToRaw)(e);m.emit("send-changes",{delta:n,id:N,objectId:t}),K(!1)}}),[m,F,U]),Object(r.useEffect)((function(){if(null!=m&&null!=F){var e=function(e){if(e.id!=N&&e.objectId==t){var n=Object(b.convertFromRaw)(e.delta),r=F.getSelection(),c=(r.getAnchorOffset(),r.getFocusOffset(),b.EditorState.set(F,{currentContent:n}));E(c)}};return m.on("receive-changes",e),function(){m.off("receive-changes",e)}}}),[m,F]),j((function(){var e=B.getHours()+":"+B.getMinutes()+":"+B.getSeconds();R(e),ee(t),console.log(F.getSelection(),t)}),[F]);var X=function(e,t){var n=e.getCurrentContent(),r=t.getCurrentContent(),c=n.getPlainText(),a=n.getFirstBlock().getCharacterList(),o=r.getPlainText(),i=r.getFirstBlock().getCharacterList();return c!=o||a!=i},Y=function(e,t){var n=e.getSelection(),r=t.getSelection(),c=n.getStartOffset(),a=r.getStartOffset(),o=n.getFocusOffset(),i=r.getFocusOffset();return c!=a||o!=i};j((function(){if(n==t&&Q.current){if(Q.current.focus(),S){var e=F.getCurrentContent(),r=F.getSelection(),c=e.getPlainText().length,a=r.merge({focusOffset:c,anchorOffset:c,hasFocus:!0});E(b.EditorState.acceptSelection(F,a)),k(!1)}if(p){if(E(b.EditorState.moveFocusToEnd(F)),v){var o=F.getCurrentContent(),i=F.getSelection(),u=i.getFocusKey(),s=o.getPlainText().length,f=te(o,v),l=Object(b.convertToRaw)(f),d=b.EditorState.createWithContent(Object(b.convertFromRaw)(l)),O=i.merge({focusKey:u,focusOffset:s,anchorOffset:s,hasFocus:!0});E(b.EditorState.acceptSelection(d,O)),C(null)}g(!1)}w&&(E(b.EditorState.moveFocusToEnd(F)),x(!1))}}),[n]),Object(r.useEffect)((function(){S||Z(t)}),[]);var Z=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("".concat(V,"/card/find"),null,"POST",{_id:t});case 2:n=e.sent,D(n),n&&(r=JSON.parse(n.content),c=b.EditorState.createWithContent(Object(b.convertFromRaw)(r)),E(c));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(s.a)(u.a.mark((function e(){var t,n,r,c,a,s=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:b.EditorState.createEmpty(),n=t.getCurrentContent(),r=Object(b.convertToRaw)(n),c=JSON.stringify(r),e.next=6,O("".concat(V,"/card/create"),null,"POST",{content:c,created:L,updater:N});case 6:a=e.sent,o(a._id),i(a._id);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=F.getCurrentContent(),r=Object(b.convertToRaw)(n),c=JSON.stringify(r),e.next=5,O("".concat(V,"/card/update"),null,"POST",{_id:t,content:c,created:L,updater:N});case 5:e.sent;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(e,t){e.getBlockMap();var n=e.getLastBlock(),r=ne(n,t);return b.ContentState.createFromBlockArray([r])},ne=function(e,t){return new b.ContentBlock({key:e.getKey(),text:e.getText().concat(t.getText()),characterList:e.getCharacterList(),depth:e.getDepth(),data:e.getData()})};return Object(h.jsx)("div",{className:"cards",onKeyDown:function(e){if(8===e.keyCode){var n=F.getCurrentContent(),r=n.getPlainText().length,o=F.getSelection(),i=o.getFocusOffset(),u=(n.getBlockMap(),n.getFirstBlock()),s=o.getAnchorOffset();if(0===i)if(0===r)g(!0),d(t);else{if(0!=s)return;g(!0),C(u),d(t)}}if("ArrowUp"===e.key)return 0===F.getSelection().getStartOffset()&&c(t),void console.log("arrow up");if("ArrowDown"===e.key)return function(){var e=F.getCurrentContent().getLastBlock().getLength();F.getSelection().getStartOffset()===e&&a(t)}(),void console.log("arrow down");if("ArrowLeft"===e.key){F.getCurrentContent();0===F.getSelection().getFocusOffset()&&(console.log("Arrow left"),c(t))}if("ArrowRight"===e.key){var f=F.getCurrentContent();F.getSelection().getFocusOffset()===f.getPlainText().length&&(console.log("Arrow right"),a(t))}if(e.key,13===e.keyCode){var l=F.getCurrentContent();if(F.getSelection().getFocusOffset()==l.getPlainText().length){console.log("newCard!!!!!!");var O=l.getFirstBlock(),j=b.ContentState.createFromBlockArray([O]),h=b.EditorState.createWithContent(j);E(h),k(!0),$()}else{E(b.EditorState.undo(F));var p=F.getSelection(),v=b.Modifier.splitBlock(l,p),S=b.ContentState.createFromBlockArray([v.getFirstBlock()]),w=b.EditorState.createWithContent(S);E(w);var x=b.ContentState.createFromBlockArray([v.getLastBlock()]),m=b.EditorState.createWithContent(x);$(m)}}},children:Object(h.jsx)(b.Editor,{editorState:F,onChange:function(e){console.log(X(F,e)),X(F,e)&&K(!0),Y(F,e)&&q(!0),E(e),i(t)},ref:Q})})},v=n(132),C="http://54.180.147.138",S=function(){var e=Object(r.useState)([]),t=Object(f.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),i=Object(f.a)(a,2),d=i[0],g=i[1],b=Object(r.useState)(!1),S=Object(f.a)(b,2),k=(S[0],S[1],Object(r.useState)([])),w=Object(f.a)(k,2),x=(w[0],w[1],Object(l.f)().userId),m=Object(r.useState)(!1),y=Object(f.a)(m,2),T=y[0],F=y[1],E=Object(r.useState)(null),B=Object(f.a)(E,2),P=B[0],A=B[1],L=Object(r.useState)(!1),R=Object(f.a)(L,2),N=R[0],I=R[1],_=Object(r.useState)(!1),D=Object(f.a)(_,2),J=D[0],M=D[1],W=Object(r.useState)(),G=Object(f.a)(W,2),U=G[0],K=G[1],z=Object(r.useState)(!1),H=Object(f.a)(z,2),q=H[0],Q=H[1],V=Object(r.useState)(0),X=Object(f.a)(V,2),Y=X[0],Z=X[1];Object(r.useEffect)((function(){ee()}),[]),Object(r.useEffect)((function(){$(n.length)&&Q(!0),Z(n.length)}),[n]);var $=function(e){return Y!=e};Object(r.useEffect)((function(){var e=Object(v.io)("http://54.180.147.138:5000");return K(e),function(){e.disconnect()}}),[]),j((function(){null!=U&&null!=n&&0!=q&&(U.emit("send-tree-changes",{delta:n,id:x}),Q(!0))}),[U,n,q]),j((function(){if(null!=U&&null!=n){U.on("receive-tree-changes",(function(e){e.id!=x&&c(e.delta)}))}}),[U,n]);var ee=function(){var e=Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("".concat(C,"/tree/find/all"),null,"GET",null);case 2:t=e.sent,c(t[0].cards);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,r,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("".concat(C,"/card/find/all"),null,"GET",null);case 2:for(n=e.sent,r=n.map((function(e){return e._id})),a=0;a<t.length;a++)-1===r.indexOf(t[a])&&(o=t.indexOf(t[a]),t.splice(o,1));c(t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(s.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return te(n),e.next=3,O("".concat(C,"/tree/update"),null,"POST",{page:t,cards:["608b3f2157e25818a1d3ff16","608b3f3557e25818a1d3ff17"]});case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),re=function(e,t){var r=n.indexOf(e);-1!==r&&0!==r&&(g(n[r-1]),M(!0))},ce=function(e){var t=n.indexOf(e);-1!==t?n[t+1]?(console.log("Nothing went wrong!"),g(n[t+1])):console.log("There is no Card After this one!!!!!"):console.log("That card uuid is Invalid!!!!!!!")},ae=function(e){var t=n.indexOf(d),r=[];if(-1===t)r=[].concat(Object(o.a)(n),[e]),c(r);else{var a=Object(o.a)(n);a.splice(t+1,0,e),c(r=a)}ne(1,r)},oe=function(){var e=n.indexOf(d);g(n[e-1]);var t=[];if(-1!==e){var r=Object(o.a)(n);r.splice(e,1),c(t=r),ne(1,t)}};return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{style:{padding:16,width:1100,backgroundColor:"white",maxWidth:1100,borderRadius:8,display:"inline-block"},children:n.map((function(e){return Object(h.jsx)(p,{uuid:e,currentCard:d,findPrevCard:re,findNextCard:ce,createdNewCardAtTree:ae,setCurrentCard:g,deleteCurrentCardFromTree:oe,setBackSpace:F,backSpace:T,mergePending:P,setMergePending:A,cardCreated:N,setCardCreated:I,goUp:J,setGoUp:M,socket:U,setSocket:K},e)}))})})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,269)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))},w=n(55);a.a.render(Object(h.jsx)(w.a,{basename:"/",children:Object(h.jsx)(l.c,{children:Object(h.jsx)(l.a,{exact:!0,path:"/collaborative_ringle_client/:userId",component:S})})}),document.getElementById("root")),k()}},[[268,1,2]]]);
//# sourceMappingURL=main.b1a08da3.chunk.js.map