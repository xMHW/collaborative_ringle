(this.webpackJsonpdocument=this.webpackJsonpdocument||[]).push([[0],{137:function(e,t,n){},238:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(71),o=n.n(a),i=(n(137),n(5)),u=n.n(i),s=n(17),f=n(8),l=n(3),d=n(6),g=n(130),O=n.n(g);function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!e.includes("undefined")){var c=null;t&&(c="Bearer "+t);var a=null;return a=r?{method:n,headers:{Authorization:c,"Content-Type":"application/json"},body:JSON.stringify(r)}:{method:n,headers:{Authorization:c,"COntent-Type":"application/json"}},O()(e,a).then((function(e){return e.json()})).then((function(e){return e}),(function(e){return{success:!1,error:e}}))}}var p=function(e,t){var n=Object(r.useRef)(!1);Object(r.useEffect)((function(){n.current?e():n.current=!0}),t)},b=n(9),h=function(e){var t=e.uuid,n=e.currentCard,c=e.findPrevCard,a=e.findNextCard,o=e.createdNewCardAtTree,i=e.setCurrentCard,g=e.deleteCurrentCardFromTree,O=e.setBackSpace,h=e.backSpace,v=e.mergePending,C=e.setMergePending,S=e.cardCreated,k=e.setCardCreated,x=e.goUp,w=e.setGoUp,m=e.socket,y=(e.setSocket,Object(r.useState)((function(){return l.EditorState.createEmpty()}))),T=Object(f.a)(y,2),F=T[0],E=T[1],B=new Date,P=Object(r.useState)(),A=Object(f.a)(P,2),L=A[0],R=A[1],N=Object(d.e)().userId,I=Object(r.useState)(),M=Object(f.a)(I,2),D=(M[0],M[1]),J=Object(r.useState)(!1),W=Object(f.a)(J,2),G=(W[0],W[1],Object(r.useState)(!1)),U=Object(f.a)(G,2),_=U[0],K=U[1],z=Object(r.useState)(!1),H=Object(f.a)(z,2),q=(H[0],H[1]),Q=Object(r.useRef)(),V="http://54.180.147.138";Object(r.useEffect)((function(){if(null!=m&&null!=F&&0!=_){var e=F.getCurrentContent(),n=Object(l.convertToRaw)(e);m.emit("send-changes",{delta:n,id:N,objectId:t}),K(!1)}}),[m,F,_]),Object(r.useEffect)((function(){if(null!=m&&null!=F){var e=function(e){if(e.id!=N&&e.objectId==t){var n=Object(l.convertFromRaw)(e.delta),r=F.getSelection(),c=(r.getAnchorOffset(),r.getFocusOffset(),l.EditorState.set(F,{currentContent:n}));E(c)}};return m.on("receive-changes",e),function(){m.off("receive-changes",e)}}}),[m,F]),p((function(){var e=B.getHours()+":"+B.getMinutes()+":"+B.getSeconds();R(e),ee(t),console.log(F.getSelection(),t)}),[F]);var X=function(e,t){var n=e.getCurrentContent(),r=t.getCurrentContent(),c=n.getPlainText(),a=n.getFirstBlock().getCharacterList(),o=r.getPlainText(),i=r.getFirstBlock().getCharacterList();return c!=o||a!=i},Y=function(e,t){var n=e.getSelection(),r=t.getSelection(),c=n.getStartOffset(),a=r.getStartOffset(),o=n.getFocusOffset(),i=r.getFocusOffset();return c!=a||o!=i};p((function(){if(n==t&&Q.current){if(Q.current.focus(),S){var e=F.getCurrentContent(),r=F.getSelection(),c=e.getPlainText().length,a=r.merge({focusOffset:c,anchorOffset:c,hasFocus:!0});E(l.EditorState.acceptSelection(F,a)),k(!1)}if(h){if(E(l.EditorState.moveFocusToEnd(F)),v){var o=F.getCurrentContent(),i=F.getSelection(),u=i.getFocusKey(),s=o.getPlainText().length,f=te(o,v),d=Object(l.convertToRaw)(f),g=l.EditorState.createWithContent(Object(l.convertFromRaw)(d)),j=i.merge({focusKey:u,focusOffset:s,anchorOffset:s,hasFocus:!0});E(l.EditorState.acceptSelection(g,j)),C(null)}O(!1)}x&&(E(l.EditorState.moveFocusToEnd(F)),w(!1))}}),[n]),Object(r.useEffect)((function(){S||Z(t)}),[]);var Z=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("".concat(V,"/card/find"),null,"POST",{_id:t});case 2:n=e.sent,D(n),n&&(r=JSON.parse(n.content),c=l.EditorState.createWithContent(Object(l.convertFromRaw)(r)),E(c));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(s.a)(u.a.mark((function e(){var t,n,r,c,a,s=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:l.EditorState.createEmpty(),n=t.getCurrentContent(),r=Object(l.convertToRaw)(n),c=JSON.stringify(r),e.next=6,j("".concat(V,"/card/create"),null,"POST",{content:c,created:L,updater:N});case 6:a=e.sent,o(a._id),i(a._id);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=F.getCurrentContent(),r=Object(l.convertToRaw)(n),c=JSON.stringify(r),e.next=5,j("".concat(V,"/card/update"),null,"POST",{_id:t,content:c,created:L,updater:N});case 5:e.sent;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(e,t){e.getBlockMap();var n=e.getLastBlock(),r=ne(n,t);return l.ContentState.createFromBlockArray([r])},ne=function(e,t){return new l.ContentBlock({key:e.getKey(),text:e.getText().concat(t.getText()),characterList:e.getCharacterList(),depth:e.getDepth(),data:e.getData()})};return Object(b.jsx)("div",{className:"cards",onKeyDown:function(e){if(8===e.keyCode){var n=F.getCurrentContent(),r=n.getPlainText().length,o=F.getSelection(),i=o.getFocusOffset(),u=(n.getBlockMap(),n.getFirstBlock()),s=o.getAnchorOffset();if(0===i)if(0===r)O(!0),g(t);else{if(0!=s)return;O(!0),C(u),g(t)}}if("ArrowUp"===e.key)return 0===F.getSelection().getStartOffset()&&c(t),void console.log("arrow up");if("ArrowDown"===e.key)return function(){var e=F.getCurrentContent().getLastBlock().getLength();F.getSelection().getStartOffset()===e&&a(t)}(),void console.log("arrow down");if("ArrowLeft"===e.key){F.getCurrentContent();0===F.getSelection().getFocusOffset()&&(console.log("Arrow left"),c(t))}if("ArrowRight"===e.key){var f=F.getCurrentContent();F.getSelection().getFocusOffset()===f.getPlainText().length&&(console.log("Arrow right"),a(t))}if(e.key,13===e.keyCode){var d=F.getCurrentContent();if(F.getSelection().getFocusOffset()==d.getPlainText().length){console.log("newCard!!!!!!");var j=d.getFirstBlock(),p=l.ContentState.createFromBlockArray([j]),b=l.EditorState.createWithContent(p);E(b),k(!0),$()}else{E(l.EditorState.undo(F));var h=F.getSelection(),v=l.Modifier.splitBlock(d,h),S=l.ContentState.createFromBlockArray([v.getFirstBlock()]),x=l.EditorState.createWithContent(S);E(x);var w=l.ContentState.createFromBlockArray([v.getLastBlock()]),m=l.EditorState.createWithContent(w);$(m)}}},children:Object(b.jsx)(l.Editor,{editorState:F,onChange:function(e){console.log(X(F,e)),X(F,e)&&K(!0),Y(F,e)&&q(!0),E(e),i(t)},ref:Q})})},v=n(57),C=(n(238),n(132)),S="http://54.180.147.138",k=function(){var e=Object(r.useState)([]),t=Object(f.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),o=Object(f.a)(a,2),i=o[0],l=o[1],g=Object(r.useState)([]),O=Object(f.a)(g,2),k=(O[0],O[1],Object(d.e)().userId),x=Object(r.useState)(!1),w=Object(f.a)(x,2),m=w[0],y=w[1],T=Object(r.useState)(null),F=Object(f.a)(T,2),E=F[0],B=F[1],P=Object(r.useState)(!1),A=Object(f.a)(P,2),L=A[0],R=A[1],N=Object(r.useState)(!1),I=Object(f.a)(N,2),M=I[0],D=I[1],J=Object(r.useState)(),W=Object(f.a)(J,2),G=W[0],U=W[1],_=Object(r.useState)(!1),K=Object(f.a)(_,2),z=K[0],H=K[1],q=Object(r.useState)(0),Q=Object(f.a)(q,2),V=Q[0],X=Q[1];Object(r.useEffect)((function(){Z()}),[]),Object(r.useEffect)((function(){Y(n.length)&&H(!0),X(n.length)}),[n]);var Y=function(e){return V!=e};Object(r.useEffect)((function(){var e=Object(C.io)("http://54.180.147.138:5000");return U(e),function(){e.disconnect()}}),[]),p((function(){null!=G&&null!=n&&0!=z&&(G.emit("send-tree-changes",{delta:n,id:k}),H(!0))}),[G,n,z]),p((function(){if(null!=G&&null!=n){G.on("receive-tree-changes",(function(e){e.id!=k&&c(e.delta)}))}}),[G,n]);var Z=function(){var e=Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("".concat(S,"/tree/find/all"),null,"GET",null);case 2:t=e.sent,c(t[0].cards);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,r,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("".concat(S,"/card/find/all"),null,"GET",null);case 2:for(n=e.sent,r=n.map((function(e){return e._id})),a=0;a<t.length;a++)-1===r.indexOf(t[a])&&(o=t.indexOf(t[a]),t.splice(o,1));c(t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(s.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $(n),e.next=3,j("".concat(S,"/tree/update"),null,"POST",{page:t,cards:n});case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),te=function(e,t){var r=n.indexOf(e);-1!==r&&0!==r&&(l(n[r-1]),D(!0))},ne=function(e){var t=n.indexOf(e);-1!==t?n[t+1]?(console.log("Nothing went wrong!"),l(n[t+1])):console.log("There is no Card After this one!!!!!"):console.log("That card uuid is Invalid!!!!!!!")},re=function(e){var t=n.indexOf(i),r=[];if(-1===t)r=[].concat(Object(v.a)(n),[e]),c(r);else{var a=Object(v.a)(n);a.splice(t+1,0,e),c(r=a)}ee(1,r)},ce=function(){var e=n.indexOf(i);l(n[e-1]);var t=[];if(-1!==e){var r=Object(v.a)(n);r.splice(e,1),c(t=r),ee(1,t)}};return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("div",{style:{padding:16,width:1100,backgroundColor:"white",maxWidth:1100,borderRadius:8,display:"inline-block"},children:n.map((function(e){return Object(b.jsx)(h,{uuid:e,currentCard:i,findPrevCard:te,findNextCard:ne,createdNewCardAtTree:re,setCurrentCard:l,deleteCurrentCardFromTree:ce,setBackSpace:y,backSpace:m,mergePending:E,setMergePending:B,cardCreated:L,setCardCreated:R,goUp:M,setGoUp:D,socket:G,setSocket:U},e)}))})})},x=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,269)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))},w=n(55);o.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsxs)(w.a,{children:[Object(b.jsx)(d.a,{exact:!0,path:"/test/:userId",component:h}),Object(b.jsx)(d.a,{exact:!0,path:"/app/:userId",component:k})]})}),document.getElementById("root")),x()}},[[268,1,2]]]);
//# sourceMappingURL=main.4f855fed.chunk.js.map